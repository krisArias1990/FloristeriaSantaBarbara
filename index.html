<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Florister√≠a Santa B√°rbara - Flores Frescas</title>
    <meta name="description" content="Florister√≠a en Santa B√°rbara, Heredia. Env√≠o a domicilio de arreglos florales, rosas, girasoles y m√°s.">
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
    
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <!-- Header -->
    <header class="main-header">
        <div class="container">
            <div class="logo">
                <h1>üå∏ Florister√≠a Santa B√°rbara</h1>
            </div>
            <nav class="main-nav" id="mainNav">
                <ul>
                    <li><a href="#inicio" onclick="closeMenu()">Inicio</a></li>
                    <li><a href="#productos" onclick="closeMenu()">Productos</a></li>
                    <li><a href="#nosotros" onclick="closeMenu()">Nosotros</a></li>
                    <li><a href="#contacto" onclick="closeMenu()">Contacto</a></li>
                </ul>
            </nav>
            <div class="header-actions">
                <button class="cart-btn" id="cartBtn" onclick="toggleCart()" aria-label="Ver carrito">
                    üõí <span class="cart-count" id="cartCount">0</span>
                </button>
                <button class="menu-toggle" id="menuToggle" onclick="toggleMenu()" aria-label="Men√∫">‚ò∞</button>
            </div>
        </div>
    </header>

    <!-- Carousel -->
    <section class="carousel" id="inicio">
        <div class="carousel-container" id="carouselContainer">
            <!-- Slides cargados din√°micamente -->
        </div>
        <div class="carousel-controls">
            <button onclick="moveCarousel(-1)" aria-label="Anterior">‚Äπ</button>
            <button onclick="moveCarousel(1)" aria-label="Siguiente">‚Ä∫</button>
        </div>
    </section>

    <!-- Productos -->
    <section class="products-section" id="productos">
        <div class="container">
            <h2>Nuestros Productos</h2>
            <div class="category-filters" id="categoryFilters">
                <button class="active" onclick="filterProducts('todos')">Todos</button>
            </div>
            <div class="product-grid" id="productGrid">
                <!-- Productos cargados din√°micamente -->
            </div>
        </div>
    </section>

    <!-- Nosotros -->
    <section class="about-section" id="nosotros">
        <div class="container">
            <h2>Sobre Nosotros</h2>
            <p>M√°s de 10 a√±os llevando alegr√≠a y color a Santa B√°rbara y alrededores. Especialistas en arreglos personalizados para toda ocasi√≥n.</p>
        </div>
    </section>

    <!-- Contacto -->
    <section class="contact-section" id="contacto">
        <div class="container">
            <h2>Contacto</h2>
            <p>üìç Santa B√°rbara, Heredia, Costa Rica</p>
            <p>üì± WhatsApp: 8605-3613</p>
        </div>
    </section>

    <!-- Modal del Carrito -->
    <div class="modal" id="cartModal" onclick="closeModalOnClickOutside(event)">
        <div class="modal-content cart-modal" onclick="event.stopPropagation()">
            <span class="close-btn" onclick="toggleCart()">&times;</span>
            <h2>üõí Tu Carrito</h2>
            <div id="cartItems" class="cart-items">
                <p class="empty-cart-msg">Tu carrito est√° vac√≠o</p>
            </div>
            <div class="cart-summary" id="cartSummary" style="display: none;">
                <div class="summary-row">
                    <span>Subtotal:</span>
                    <span id="subtotal">‚Ç°0</span>
                </div>
                <div class="summary-row">
                    <span>Env√≠o:</span>
                    <span id="shippingCost">‚Ç°0</span>
                </div>
                <div class="summary-row total">
                    <span>Total:</span>
                    <span id="total">‚Ç°0</span>
                </div>
            </div>
            <button class="checkout-btn" id="checkoutBtn" onclick="openCheckout()" disabled>Proceder al Pago</button>
        </div>
    </div>

    <!-- Modal de Checkout -->
    <div class="modal" id="checkoutModal" onclick="closeModalOnClickOutside(event)">
        <div class="modal-content checkout-modal" onclick="event.stopPropagation()">
            <span class="close-btn" onclick="closeCheckout()">&times;</span>
            <h2>üìù Finalizar Pedido</h2>
            
            <form id="orderForm" onsubmit="processOrder(event)">
                <!-- Destinatario -->
                <div class="form-section">
                    <h3>üë§ Datos de quien RECIBE *</h3>
                    <div class="form-group">
                        <label for="receiverName">Nombre completo</label>
                        <input type="text" id="receiverName" required placeholder="Nombre de quien recibe las flores">
                    </div>
                    <div class="form-group">
                        <label for="receiverPhone">Tel√©fono (8 d√≠gitos)</label>
                        <input type="tel" id="receiverPhone" required placeholder="88888888" pattern="[0-9]{8}" maxlength="8" oninput="validatePhone(this)">
                        <small>Ejemplo: 88888888 (sin espacios ni guiones)</small>
                    </div>
                </div>

                <!-- Remitente -->
                <div class="form-section">
                    <h3>üíù Datos de quien ENV√çA *</h3>
                    <div class="form-group">
                        <label for="senderName">Nombre completo</label>
                        <input type="text" id="senderName" required placeholder="Tu nombre">
                    </div>
                    <div class="form-group">
                        <label for="senderPhone">Tel√©fono (8 d√≠gitos)</label>
                        <input type="tel" id="senderPhone" required placeholder="88888888" pattern="[0-9]{8}" maxlength="8" oninput="validatePhone(this)">
                    </div>
                </div>

                <!-- Entrega -->
                <div class="form-section">
                    <h3>üöö Tipo de Entrega *</h3>
                    <div class="form-group">
                        <label for="deliveryType">¬øC√≥mo prefieres recibir tu pedido?</label>
                        <select id="deliveryType" required onchange="toggleDeliveryOptions()">
                            <option value="">Selecciona una opci√≥n</option>
                            <option value="delivery">üöö Env√≠o a domicilio</option>
                            <option value="pickup">üè™ Recoger en tienda</option>
                        </select>
                    </div>

                    <div id="deliveryOptions" style="display: none;">
                        <div class="form-group">
                            <label for="address">Direcci√≥n exacta *</label>
                            <input type="text" id="address" placeholder="Calle, avenida, n√∫mero de casa, barrio">
                        </div>
                        
                        <button type="button" class="location-btn" onclick="toggleMap()">
                            üìç Marcar ubicaci√≥n exacta en el mapa
                        </button>
                        
                        <div id="map" class="map-container"></div>
                        
                        <div id="distanceInfo" class="distance-info">
                            <div class="distance-details">
                                <span>üìè Distancia: <strong id="distanceKm">0</strong> km</span>
                                <span>üí∞ Costo env√≠o: <strong id="calculatedShipping">‚Ç°0</strong></span>
                            </div>
                            <small>Se calcula autom√°ticamente desde nuestra ubicaci√≥n</small>
                        </div>

                        <div class="form-group">
                            <label for="landmarks">Se√±as espec√≠ficas (opcional)</label>
                            <textarea id="landmarks" rows="2" placeholder="Color de casa, cerca de qu√© lugar, etc."></textarea>
                        </div>
                    </div>
                </div>

                <!-- Detalles -->
                <div class="form-section">
                    <h3>üíå Detalles del Pedido</h3>
                    <div class="form-group">
                        <label for="cardMessage">Mensaje para la tarjeta (m√°x. 200 caracteres)</label>
                        <textarea id="cardMessage" rows="3" maxlength="200" placeholder="Escribe tu mensaje..." oninput="updateCharCount(this)"></textarea>
                        <small id="charCount">0/200 caracteres</small>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="deliveryDate">Fecha de entrega *</label>
                            <input type="date" id="deliveryDate" required>
                        </div>
                        <div class="form-group">
                            <label for="deliveryTime">Horario *</label>
                            <select id="deliveryTime" required>
                                <option value="">Selecciona</option>
                                <option value="morning">Ma√±ana (8am-12pm)</option>
                                <option value="afternoon">Tarde (12pm-5pm)</option>
                                <option value="evening">Noche (5pm-8pm)</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="paymentMethod">M√©todo de Pago *</label>
                        <select id="paymentMethod" required onchange="showPaymentInfo()">
                            <option value="">Selecciona m√©todo</option>
                            <option value="sinpe">üì± SINPE M√≥vil</option>
                            <option value="cash">üíµ Efectivo</option>
                            <option value="transfer">üè¶ Transferencia BAC</option>
                        </select>
                    </div>
                </div>

                <!-- Resumen -->
                <div class="form-section">
                    <h3>üíµ Resumen del Pedido</h3>
                    <div id="orderItemsPreview" class="order-preview"></div>
                    <div class="order-totals">
                        <div class="summary-row">
                            <span>Subtotal:</span>
                            <span id="checkoutSubtotal">‚Ç°0</span>
                        </div>
                        <div class="summary-row">
                            <span>Env√≠o:</span>
                            <span id="checkoutShipping">‚Ç°0</span>
                        </div>
                        <div class="summary-row total">
                            <span>TOTAL:</span>
                            <span id="checkoutTotal">‚Ç°0</span>
                        </div>
                    </div>
                </div>

                <!-- Info de pago -->
                <div class="payment-info" id="paymentInfoSinpe" style="display: none;">
                    <h4>üì± Pago por SINPE M√≥vil</h4>
                    <p><strong>N√∫mero:</strong> 8605-3613</p>
                    <p><strong>A nombre de:</strong> Florister√≠a Santa B√°rbara</p>
                    <small>Env√≠a el comprobante por WhatsApp despu√©s de ordenar</small>
                </div>

                <div class="payment-info" id="paymentInfoTransfer" style="display: none;">
                    <h4>üè¶ Pago por Transferencia</h4>
                    <p><strong>Banco:</strong> BAC</p>
                    <p><strong>Cuenta:</strong> 123456789</p>
                    <p><strong>A nombre de:</strong> Florister√≠a Santa B√°rbara S.A.</p>
                </div>

                <button type="submit" class="submit-order-btn">
                    üì≤ Enviar Pedido por WhatsApp
                </button>
            </form>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast"></div>

    <!-- Scripts -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <script src="js/db.js"></script>
    <script src="js/carousel.js"></script>
    <script src="js/cart.js"></script>
    <script src="js/main.js"></script>
</body>
</html>
